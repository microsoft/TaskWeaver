<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">What makes a good agent reasoning framework? | TaskWeaver</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docusaurus.io/TaskWeaver/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://docusaurus.io/TaskWeaver/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://docusaurus.io/TaskWeaver/blog/reasoning"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="What makes a good agent reasoning framework? | TaskWeaver"><meta data-rh="true" name="description" content="An agent can listen to the user&#x27;s request, understand the context, make plans, take actions, observe the results, and respond to the user. Its behavior is driven by the reasoning process, which is the core of the agent&#x27;s intelligence."><meta data-rh="true" property="og:description" content="An agent can listen to the user&#x27;s request, understand the context, make plans, take actions, observe the results, and respond to the user. Its behavior is driven by the reasoning process, which is the core of the agent&#x27;s intelligence."><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2025-01-20T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://liqul.github.io"><link data-rh="true" rel="icon" href="/TaskWeaver/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docusaurus.io/TaskWeaver/blog/reasoning"><link data-rh="true" rel="alternate" href="https://docusaurus.io/TaskWeaver/blog/reasoning" hreflang="en"><link data-rh="true" rel="alternate" href="https://docusaurus.io/TaskWeaver/blog/reasoning" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://docusaurus.io/TaskWeaver/blog/reasoning","mainEntityOfPage":"https://docusaurus.io/TaskWeaver/blog/reasoning","url":"https://docusaurus.io/TaskWeaver/blog/reasoning","headline":"What makes a good agent reasoning framework?","name":"What makes a good agent reasoning framework?","description":"An agent can listen to the user's request, understand the context, make plans, take actions, observe the results, and respond to the user. Its behavior is driven by the reasoning process, which is the core of the agent's intelligence.","datePublished":"2025-01-20T00:00:00.000Z","author":{"@type":"Person","name":"Liqun Li","description":"Principal Researcher","url":"https://liqul.github.io","image":"https://liqul.github.io/assets/logo_small_bw.png"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://docusaurus.io/TaskWeaver/blog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/TaskWeaver/blog/rss.xml" title="TaskWeaver RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/TaskWeaver/blog/atom.xml" title="TaskWeaver Atom Feed"><link rel="stylesheet" href="/TaskWeaver/assets/css/styles.4f14592f.css">
<script src="/TaskWeaver/assets/js/runtime~main.6cfe51d5.js" defer="defer"></script>
<script src="/TaskWeaver/assets/js/main.1651dd3d.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/TaskWeaver/"><div class="navbar__logo"><img src="/TaskWeaver/img/logo.svg" alt="TaskWeaver Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/TaskWeaver/img/logo.svg" alt="TaskWeaver Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">TaskWeaver</b></a><a class="navbar__item navbar__link" href="/TaskWeaver/docs/overview">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/TaskWeaver/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/microsoft/taskweaver/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" hidden="" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">All posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2025</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/TaskWeaver/blog/vision">Vision input for the Planner</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/TaskWeaver/blog/reasoning">What makes a good agent reasoning framework?</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2024</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/TaskWeaver/blog/experience">Experience Selection in TaskWeaver</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/TaskWeaver/blog/local_llm">Run TaskWeaver with Locally Deployed Not-that-Large Language Models</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/TaskWeaver/blog/plugin">Plugins In-Depth</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/TaskWeaver/blog/evaluation">How to evaluate a LLM agent?</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/TaskWeaver/blog/role">Roles in TaskWeaver</a></li></ul></div></nav></aside><main class="col col--7"><article><header><h1 class="title_f1Hy">What makes a good agent reasoning framework?</h1><div class="container_mt6G margin-vert--md"><time datetime="2025-01-20T00:00:00.000Z">January 20, 2025</time> · <!-- -->21 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://liqul.github.io" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://liqul.github.io/assets/logo_small_bw.png" alt="Liqun Li"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://liqul.github.io" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">Liqun Li</span></a></div><small class="authorTitle_nd0D" title="Principal Researcher">Principal Researcher</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p>An agent can listen to the user&#x27;s request, understand the context, make plans, take actions, observe the results, and respond to the user. Its behavior is driven by the reasoning process, which is the core of the agent&#x27;s intelligence.</p>
<p>There are many techniques developed to build an agent reasoning framework. For example, Chain-of-Thought (CoT) is one of the most popular reasoning approaches that uses a chain of thought to generate next-step actions. Another technique is ReAct, where the agent reflect on its action results to adjust its future actions. In TaskWeaver, one of the key reasoning technique is task decomposition and tracking, where the agent breaks down a task into subtasks and keeps track of the progress of each subtask. The following snippet shows an example of task decomposition and tracking in TaskWeaver:</p>
<div class="language-commandline codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-commandline codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">├─► [init_plan]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   1. Request historical stock price data for MSFT from the user</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   2. Request the forecasting model or method to be used for prediction &lt;interactively depends on 1&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   3. Perform the prediction using the provided data and model &lt;interactively depends on 2&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   4. Report the prediction results to the user &lt;interactively depends on 3&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">├─► [plan]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   1. Request historical stock price data for MSFT from the user</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   2. Request the forecasting model or method to be used for prediction</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   3. Perform the prediction using the provided data and model</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   4. Report the prediction results to the user</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">├─► [current_plan_step] 1. Request historical stock price data for MSFT from the user</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The agent lists the steps of the plan and the current step it is working on. While the agent is working on the task, it keeps track of the current step. This is useful especially when the task is complex and requires multiple steps to complete. The agent can refer to the current step to know what to do next. Without task decomposition and tracking, the agent may lose track of the task and fail to complete it.</p>
<p>TaskWeaver also support ReAct-like reasoning. This is done by introducing multiple roles in the problem-solving process, especially the Planner and CodeInterpreter roles. The Planner role is responsible for planning the steps of the task, while the CodeInterpreter role is responsible for interpreting the code generated by the Planner. The Planner can reflect on the results of the CodeInterpreter and adjust the plan accordingly. In one round, the Planner and Code Interpreter can work together to complete a subtask with multiple interactions.</p>
<p>However, there are still situations where the agent reasoning framework can be improved. If you have read the discussion above, you may have noticed that CoT is not implemented in TaskWeaver.</p>
<p><strong>Why?</strong></p>
<p>In this article, we are focused on the reasoning in the Planner. In fact, the Code Interpreter has CoT implemented as shown in the following snippet:</p>
<div class="language-commandline codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-commandline codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">├─► [thought] To fetch historical stock price data for MSFT using yfinance, I will first try to import yfinance and download the data. If yfinance is not installed, I will provide instructions to install it.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">├─► [reply_type] python</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">├─► [reply_content]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   import yfinance as yf</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   # Fetch historical stock price data for MSFT</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   ticker = &#x27;MSFT&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   msft_data = yf.download(ticker, start=&#x27;2020-01-01&#x27;, end=&#x27;2025-01-01&#x27;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   msft_data</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For the Planner, there are actually two places in the response schema where CoT can be implemented: before generating the <code>init_plan</code> and after the <code>current_plan_step</code>, as shown in the previous snippet. The former is to generate the initial plan, while the latter is to use Planner&#x27;s reasoning capabilities to solve the current subtask.</p>
<p>The former was not implemented in TaskWeaver for two reasons: (1) to simplify the schema and save the reasoning time/prompt size; (2) the existing <code>init_plan</code> and <code>plan</code> already represent a thought process, and adding CoT may not bring significant benefits. But as the LLM becomes faster and cheaper, it is possible to add CoT to the Planner to improve the planning quality.</p>
<p>With reasoning for planning, the output of the Planner looks like this:</p>
<div class="language-commandline codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-commandline codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"> Human   ▶  predict msft&#x27;s stock price in the next 7 days</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ╭───&lt; Planner &gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [plan_reasoning] The user wants to predict Microsoft&#x27;s stock price for the next 7 days. This task involves time series forecasting, which requires historical stock price data and a forecasting model. However, the user hasn&#x27;t provided any data or specified a model to use. I need to ask the user for more information.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [init_plan]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   1. Request historical stock price data from the user</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   2. Ask the user to specify a forecasting model or confirm if a default model should be used</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   3. Load the historical stock price data &lt;interactively depends on 1&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   4. Train the forecasting model using the historical data &lt;interactively depends on 2 and 3&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   5. Predict the stock price for the next 7 days &lt;sequentially depends on 4&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   6. Report the prediction results to the user &lt;interactively depends on 5&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>It looks good, but it is not the most important part of this article. The latter is more interesting and also more challenging to implement than it looks.</p>
<p>Let&#x27;s use an example to motivate the necessity and explain the challenges. The task is described as follows and all the data in it are fake:</p>
<div class="language-markdown codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-markdown codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token title important punctuation" style="color:rgb(248, 248, 242)">#</span><span class="token title important"> Task Instructions  </span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token title important punctuation" style="color:rgb(248, 248, 242)">##</span><span class="token title important"> Step 1: Extract Employee Data  </span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Extract the following information from the employee summary:  </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token list punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token code-snippet code keyword" style="color:rgb(189, 147, 249);font-style:italic">`Employee ID`</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token list punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token code-snippet code keyword" style="color:rgb(189, 147, 249);font-style:italic">`Department`</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token list punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token code-snippet code keyword" style="color:rgb(189, 147, 249);font-style:italic">`Project Code`</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token list punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token code-snippet code keyword" style="color:rgb(189, 147, 249);font-style:italic">`Role`</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token list punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token code-snippet code keyword" style="color:rgb(189, 147, 249);font-style:italic">`Manager`</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token list punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token code-snippet code keyword" style="color:rgb(189, 147, 249);font-style:italic">`Location`</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token title important punctuation" style="color:rgb(248, 248, 242)">###</span><span class="token title important"> Employee Summary  </span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">On April 10, 2025, a review was conducted for an employee with ID </span><span class="token code-snippet code keyword" style="color:rgb(189, 147, 249);font-style:italic">`E12345`</span><span class="token plain">. </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">The employee is part of the </span><span class="token code-snippet code keyword" style="color:rgb(189, 147, 249);font-style:italic">`Development`</span><span class="token plain"> department and is currently assigned to project code </span><span class="token code-snippet code keyword" style="color:rgb(189, 147, 249);font-style:italic">`&quot;X987&quot;`</span><span class="token plain">. </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">The role held is </span><span class="token code-snippet code keyword" style="color:rgb(189, 147, 249);font-style:italic">`&quot;Software Engineer&quot;`</span><span class="token plain"> under the supervision of manager </span><span class="token code-snippet code keyword" style="color:rgb(189, 147, 249);font-style:italic">`&quot;J. Doe.&quot;`</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">The primary work location is </span><span class="token code-snippet code keyword" style="color:rgb(189, 147, 249);font-style:italic">`&quot;Remote.&quot;`</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token title important punctuation" style="color:rgb(248, 248, 242)">##</span><span class="token title important"> Step 2: Validate the Role  </span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token list punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> Confirm if the role is recognized among the following: Software Engineer, Data Analyst, Project Manager, DevOps Specialist, QA Tester.  </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token list punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> Check if the role is one of the recognized roles.  </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token title important punctuation" style="color:rgb(248, 248, 242)">##</span><span class="token title important"> Step 3: Construct SQL Query  </span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token title important">Prepare and print the SQL query using the extracted details:  </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token title important"></span><span class="token title important punctuation" style="color:rgb(248, 248, 242)">===</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SELECT EmployeeID, Department, ProjectCode, Role, Manager, Location  </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">FROM EmployeeRecords  </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">WHERE EmployeeID = &#x27;{EmployeeID}&#x27;  </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">AND Department = &#x27;{Department}&#x27;  </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">AND ProjectCode = &#x27;{ProjectCode}&#x27;  </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">AND Role = &#x27;{Role}&#x27;  </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">AND Manager = &#x27;{Manager}&#x27;  </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">AND Location = &#x27;{Location}&#x27;  </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token title important">ORDER BY EmployeeID;  </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token title important"></span><span class="token title important punctuation" style="color:rgb(248, 248, 242)">===</span><span class="token plain"> </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The task has 3 steps: extract employee data, validate the role, and construct an SQL query. This would not be a hard problem for any ReAct based agents. Actually, for all the 3 steps, there is no need to call Code Interpreter. The Planner can reason through the task and generate the code directly. However, let&#x27;s run it in TaskWeaver:</p>
<div class="language-commandline codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-commandline codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ╭───&lt; Planner &gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [plan_reasoning] The user has provided a task with specific instructions to be followed step by step. The task involves extracting employee data, validating the role, and constructing an SQL query. Each step is dependent on</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │    the completion of the previous one, so they must be executed in sequence.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [init_plan]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   1. Extract the specified employee data from the summary provided.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   2. Validate the role against the recognized roles list &lt;sequentially depends on 1&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   3. Construct the SQL query using the extracted details &lt;sequentially depends on 2&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   4. Report the constructed SQL query to the user &lt;interactively depends on 3&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [plan]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   1. Extract the specified employee data from the summary provided.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   2. Validate the role against the recognized roles list.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   3. Construct the SQL query using the extracted details.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   4. Report the constructed SQL query to the user.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [current_plan_step] 1. Extract the specified employee data from the summary provided.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [stop] InProcess</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├──● Please extract the following information from the employee summary: Employee ID, Department, Project Code, Role, Manager, and Location. The summary is: On April 10, 2025, a review was conducted for an employee with ID     </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   `E12345`. The employee is part of the `Development` department and is currently assigned to project code `&quot;X987&quot;`. The role held is `&quot;Software Engineer&quot;` under the supervision of manager `&quot;J. Doe.&quot;` The primary work        </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   location is `&quot;Remote.&quot;`</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [shared_memory_entry] Add the plan to the shared memory</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ╰──● sending message to CodeInterpreter</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ╭───&lt; CodeInterpreter &gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [thought] I will extract the required information from the given employee summary using string manipulation techniques.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [reply_type] python</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [reply_content]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   employee_summary = &quot;On April 10, 2025, a review was conducted for an employee with ID `E12345`. The employee is part of the `Development` department and is currently assigned to project code \&quot;X987\&quot;. The role held is      </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   \&quot;Software Engineer\&quot; under the supervision of manager \&quot;J. Doe.\&quot; The primary work location is \&quot;Remote.\&quot;&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   # Extracting information</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   employee_id = employee_summary.split(&#x27;ID `&#x27;)[1].split(&#x27;`&#x27;)[0]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   department = employee_summary.split(&#x27;`&#x27;)[3]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   project_code = employee_summary.split(&#x27;project code \&quot;&#x27;)[1].split(&#x27;\&quot;&#x27;)[0]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   role = employee_summary.split(&#x27;role held is \&quot;&#x27;)[1].split(&#x27;\&quot;&#x27;)[0]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   manager = employee_summary.split(&#x27;manager \&quot;&#x27;)[1].split(&#x27;\&quot;&#x27;)[0]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   location = employee_summary.split(&#x27;location is \&quot;&#x27;)[1].split(&#x27;\&quot;&#x27;)[0]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   employee_id, department, project_code, role, manager, location</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [verification] NONE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [code_error] No code verification is performed.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [execution_status] SUCCESS</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [execution_result]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   The execution of the generated python code above has succeeded</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   The result of above Python code after execution is:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   (&#x27;E12345&#x27;, &#x27;Development&#x27;, &#x27;X987&#x27;, &#x27;Software Engineer&#x27;, &#x27;J. Doe.&#x27;, &#x27;Remote.&#x27;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [artifact_paths] []</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├──● The following python code has been executed:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   ```python</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   employee_summary = &quot;On April 10, 2025, a review was conducted for an employee with ID `E12345`. The employee is part of the `Development` department and is currently assigned to project code \&quot;X987\&quot;. The role held is      </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   \&quot;Software Engineer\&quot; under the supervision of manager \&quot;J. Doe.\&quot; The primary work location is \&quot;Remote.\&quot;&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   # Extracting information</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   employee_id = employee_summary.split(&#x27;ID `&#x27;)[1].split(&#x27;`&#x27;)[0]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   department = employee_summary.split(&#x27;`&#x27;)[3]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   project_code = employee_summary.split(&#x27;project code \&quot;&#x27;)[1].split(&#x27;\&quot;&#x27;)[0]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   role = employee_summary.split(&#x27;role held is \&quot;&#x27;)[1].split(&#x27;\&quot;&#x27;)[0]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   manager = employee_summary.split(&#x27;manager \&quot;&#x27;)[1].split(&#x27;\&quot;&#x27;)[0]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   location = employee_summary.split(&#x27;location is \&quot;&#x27;)[1].split(&#x27;\&quot;&#x27;)[0]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   employee_id, department, project_code, role, manager, location</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   ```</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   The execution of the generated python code above has succeeded</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   The result of above Python code after execution is:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   (&#x27;E12345&#x27;, &#x27;Development&#x27;, &#x27;X987&#x27;, &#x27;Software Engineer&#x27;, &#x27;J. Doe.&#x27;, &#x27;Remote.&#x27;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ╰──● sending message to Planner</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ╭───&lt; Planner &gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [plan_reasoning] The employee data has been successfully extracted from the summary. The next step is to validate the role against the list of recognized roles.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [init_plan]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   1. Extract the specified employee data from the summary provided.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   2. Validate the role against the recognized roles list &lt;sequentially depends on 1&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   3. Construct the SQL query using the extracted details &lt;sequentially depends on 2&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   4. Report the constructed SQL query to the user &lt;interactively depends on 3&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [plan]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   1. Extract the specified employee data from the summary provided.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   2. Validate the role against the recognized roles list.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   3. Construct the SQL query using the extracted details.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   4. Report the constructed SQL query to the user.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [current_plan_step] 2. Validate the role against the recognized roles list.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [stop] InProcess</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├──● Please validate if the role &#x27;Software Engineer&#x27; is recognized among the following roles: Software Engineer, Data Analyst, Project Manager, DevOps Specialist, QA Tester.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [shared_memory_entry] Add the plan to the shared memory</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ╰──● sending message to CodeInterpreter</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ╭───&lt; CodeInterpreter &gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [thought] I will validate if the role &#x27;Software Engineer&#x27; is recognized among the given list of roles.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [reply_type] python</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [reply_content]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   # Step 2: Validate the Role</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   recognized_roles = [&quot;Software Engineer&quot;, &quot;Data Analyst&quot;, &quot;Project Manager&quot;, &quot;DevOps Specialist&quot;, &quot;QA Tester&quot;]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   role = &quot;Software Engineer&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   is_role_recognized = role in recognized_roles</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   is_role_recognized</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [verification] NONE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [code_error] No code verification is performed.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [execution_status] SUCCESS</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [execution_result]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   The execution of the generated python code above has succeeded</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   The result of above Python code after execution is:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   True</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [artifact_paths] []</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├──● The following python code has been executed:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   ```python</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   # Step 2: Validate the Role</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   recognized_roles = [&quot;Software Engineer&quot;, &quot;Data Analyst&quot;, &quot;Project Manager&quot;, &quot;DevOps Specialist&quot;, &quot;QA Tester&quot;]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   role = &quot;Software Engineer&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   is_role_recognized = role in recognized_roles</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   is_role_recognized</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   ```</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   The execution of the generated python code above has succeeded</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   The result of above Python code after execution is:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   True</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ╰──● sending message to Planner</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ╭───&lt; Planner &gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [plan_reasoning] The role &#x27;Software Engineer&#x27; is recognized among the list of roles. The next step is to construct the SQL query using the extracted details.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [init_plan]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   1. Extract the specified employee data from the summary provided.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   2. Validate the role against the recognized roles list &lt;sequentially depends on 1&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   3. Construct the SQL query using the extracted details &lt;sequentially depends on 2&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   4. Report the constructed SQL query to the user &lt;interactively depends on 3&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [plan]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   1. Extract the specified employee data from the summary provided.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   2. Validate the role against the recognized roles list.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   3. Construct the SQL query using the extracted details.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   4. Report the constructed SQL query to the user.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [current_plan_step] 3. Construct the SQL query using the extracted details.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [stop] InProcess</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├──● Please construct the SQL query using the extracted details: Employee ID &#x27;E12345&#x27;, Department &#x27;Development&#x27;, Project Code &#x27;X987&#x27;, Role &#x27;Software Engineer&#x27;, Manager &#x27;J. Doe.&#x27;, and Location &#x27;Remote&#x27;. The SQL query should be  </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   in the format provided in the task instructions.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [shared_memory_entry] Add the plan to the shared memory</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ╰──● sending message to CodeInterpreter</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ╭───&lt; CodeInterpreter &gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [thought] I will construct the SQL query using the extracted details from the previous successful round.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [reply_type] python</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [reply_content]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   # Step 3: Construct SQL Query</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   employee_id = &#x27;E12345&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   department = &#x27;Development&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   project_code = &#x27;X987&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   role = &#x27;Software Engineer&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   manager = &#x27;J. Doe.&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   location = &#x27;Remote.&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   sql_query = f&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   SELECT EmployeeID, Department, ProjectCode, Role, Manager, Location</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   FROM EmployeeRecords</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   WHERE EmployeeID = &#x27;{employee_id}&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   AND Department = &#x27;{department}&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   AND ProjectCode = &#x27;{project_code}&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   AND Role = &#x27;{role}&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   AND Manager = &#x27;{manager}&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   AND Location = &#x27;{location}&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   ORDER BY EmployeeID;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   sql_query</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [verification] NONE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [code_error] No code verification is performed.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [execution_status] SUCCESS</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [execution_result]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   The execution of the generated python code above has succeeded</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   The result of above Python code after execution is:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   SELECT EmployeeID, Department, ProjectCode, Role, Manager, Location</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   FROM EmployeeRecords</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   WHERE EmployeeID = &#x27;E12345&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   AND Department = &#x27;Development&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   AND ProjectCode = &#x27;X987&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   AND Role = &#x27;Software Engineer&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   AND Manager = &#x27;J. Doe.&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   AND Location = &#x27;Remote.&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   ORDER BY EmployeeID;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [artifact_paths] []</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├──● The following python code has been executed:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   ```python</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   # Step 3: Construct SQL Query</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   employee_id = &#x27;E12345&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   department = &#x27;Development&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   project_code = &#x27;X987&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   role = &#x27;Software Engineer&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   manager = &#x27;J. Doe.&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   location = &#x27;Remote.&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   sql_query = f&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   SELECT EmployeeID, Department, ProjectCode, Role, Manager, Location</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   FROM EmployeeRecords</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   WHERE EmployeeID = &#x27;{employee_id}&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   AND Department = &#x27;{department}&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   AND ProjectCode = &#x27;{project_code}&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   AND Role = &#x27;{role}&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   AND Manager = &#x27;{manager}&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   AND Location = &#x27;{location}&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   ORDER BY EmployeeID;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   sql_query</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   ```</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   The execution of the generated python code above has succeeded</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   The result of above Python code after execution is:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   SELECT EmployeeID, Department, ProjectCode, Role, Manager, Location</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   FROM EmployeeRecords</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   WHERE EmployeeID = &#x27;E12345&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   AND Department = &#x27;Development&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   AND ProjectCode = &#x27;X987&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   AND Role = &#x27;Software Engineer&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   AND Manager = &#x27;J. Doe.&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   AND Location = &#x27;Remote.&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   ORDER BY EmployeeID;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ╰──● sending message to Planner</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ╭───&lt; Planner &gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [plan_reasoning] The SQL query has been successfully constructed using the extracted employee details. The task is now complete, and the constructed SQL query can be reported to the user.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [init_plan]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   1. Extract the specified employee data from the summary provided.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   2. Validate the role against the recognized roles list &lt;sequentially depends on 1&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   3. Construct the SQL query using the extracted details &lt;sequentially depends on 2&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   4. Report the constructed SQL query to the user &lt;interactively depends on 3&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [plan]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   1. Extract the specified employee data from the summary provided.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   2. Validate the role against the recognized roles list.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   3. Construct the SQL query using the extracted details.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   4. Report the constructed SQL query to the user.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [current_plan_step] 4. Report the constructed SQL query to the user.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [stop] Completed</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├──● The SQL query has been successfully constructed using the extracted details:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   ```</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   SELECT EmployeeID, Department, ProjectCode, Role, Manager, Location</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   FROM EmployeeRecords</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   WHERE EmployeeID = &#x27;E12345&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   AND Department = &#x27;Development&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   AND ProjectCode = &#x27;X987&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   AND Role = &#x27;Software Engineer&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   AND Manager = &#x27;J. Doe.&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   AND Location = &#x27;Remote.&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   ORDER BY EmployeeID;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> │   ```</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ├─► [shared_memory_entry] Add the plan to the shared memory</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ╰──● sending message to User</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> TaskWeaver ▶  The SQL query has been successfully constructed using the extracted details:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SELECT EmployeeID, Department, ProjectCode, Role, Manager, Location</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">FROM EmployeeRecords</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">WHERE EmployeeID = &#x27;E12345&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">AND Department = &#x27;Development&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">AND ProjectCode = &#x27;X987&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">AND Role = &#x27;Software Engineer&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">AND Manager = &#x27;J. Doe.&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">AND Location = &#x27;Remote.&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ORDER BY EmployeeID;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The log is quite lengthy, but it is quite clear and easy to understand. For each step, the Planner always asks the Code Interpreter to generate the code. Finally, the task is completed successfully. However, it is not the most efficient way to solve the task because the Planner can leverage its reasoning capabilities to extract information and construct the SQL query directly.</p>
<p>We have tried to add instructions in the Planner&#x27;s prompt to emphasize the reasoning power, but the Planner still calls the Code Interpreter to generate the code. For a long time, we don&#x27;t quite understand the reason behind this behavior. After many discussions and experiments, we finally realized that it is caused by the design of the Planner&#x27;s response schema. The Planner needs to talk to another Role in the system each time. But if we want the Planner to use reasoning to solve the current subtask, who should the Planner talk to? Ideally, it should continue until the subtask that requires the Code Interpreter to generate the code. But how can we design the schema to support this? Because the Planner is explicitly tracking the progress, i.e., the <code>current_plan_step</code>, it is confusing to let the Planner continue the reasoning process through future steps.</p>
<p>We value the progress tracking more than the efficiency of the reasoning process, because this is critical for complex multi-step tasks. But we also want to improve the reasoning process to make the agent more intelligent. So, our choice is to add a special Role called <code>Recepta</code> to listen to the Planner&#x27;s reasoning process when the Planner wants to use reasoning to solve the current subtask. The <code>Recepta</code> always answers &quot;Got it. Please go ahead!&quot; to the Planner. The Planner can then continue the reasoning process until the subtask that requires the Code Interpreter to generate the code. The <code>Recepta</code> is not a real Role in the system, but a design pattern to support the reasoning process in the Planner.</p>
<p>Now, let&#x27;s look at the output of TaskWeaver with <code>Recepta</code>:</p>
<div class="language-commandline codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-commandline codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">╭───&lt; Planner &gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">├─► [plan_reasoning] The user has provided a set of instructions to follow step by step. The task involves extracting employee data from a summary, validating the role, and constructing an SQL query. I will follow these steps sequentially.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">├─► [init_plan]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   1. Extract the following information from the employee summary: `Employee ID`, `Department`, `Project Code`, `Role`, `Manager`, `Location`</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   2. Validate the role &lt;interactively depends on 1&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   3. Construct and print the SQL query using the extracted details &lt;interactively depends on 1&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   4. Check the execution result and report the result to the user &lt;interactively depends on 1 and 3&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">├─► [plan]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   1. Extract information from the employee summary</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   2. Validate the role</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   3. Construct SQL query using the extracted details</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   4. Report the result to the user</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">├─► [current_plan_step] 1. Extract information from the employee summary</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">├─► [stop] InProcess</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">├──● Thought: I can read and comprehend the employee summary to extract the required information.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   Result: the `Employee ID` is `E12345`, the `Department` is `Development`, the `Project Code` is `X987`, the `Role` is `Software Engineer`, the `Manager` is `J. Doe`, and the `Location` is `Remote`.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">├─► [shared_memory_entry] Add the plan to the shared memory</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">╰──● sending message to Recepta</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">╭───&lt; Recepta &gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">├──● Got it. Now, please go ahead!</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">╰──● sending message to Planner</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">╭───&lt; Planner &gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">├─► [plan_reasoning] I have extracted the information from the employee summary. The next step is to verify if the role is one of the recognized roles.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">├─► [init_plan]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   1. Extract the following information from the employee summary: `Employee ID`, `Department`, `Project Code`, `Role`, `Manager`, `Location`</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   2. Validate the role &lt;interactively depends on 1&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   3. Construct and print the SQL query using the extracted details &lt;interactively depends on 1&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   4. Check the execution result and report the result to the user &lt;interactively depends on 1 and 3&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">├─► [plan]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   1. Extract information from the employee summary</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   2. Validate the role</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   3. Construct SQL query using the extracted details</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   4. Report the result to the user</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">├─► [current_plan_step] 2. Validate the role</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">├─► [stop] InProcess</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">├──● Thought: I can verify if the role is one of the recognized roles with my pattern matching capability.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   Thought: The recognized roles are `Software Engineer, Data Analyst, Project Manager, DevOps Specialist, QA Tester`.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   Result: The role is `Software Engineer`, which is recognized.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">├─► [shared_memory_entry] Add the plan to the shared memory</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">╰──● sending message to Recepta</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">╭───&lt; Recepta &gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">├──● Got it. Now, please go ahead!</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">╰──● sending message to Planner</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">╭───&lt; Planner &gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">├─► [plan_reasoning] I can prepare and print the SQL query using the extracted details to the User.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">├─► [init_plan]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   1. Extract the following information from the employee summary: `Employee ID`, `Department`, `Project Code`, `Role`, `Manager`, `Location`</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   2. Validate the role &lt;interactively depends on 1&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   3. Construct and print the SQL query using the extracted details &lt;interactively depends on 1&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   4. Check the execution result and report the result to the user &lt;interactively depends on 1 and 3&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">├─► [plan]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   1. Extract information from the employee summary</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   2. Validate the role</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   3. Construct SQL query using the extracted details</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   4. Report the result to the user</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">├─► [current_plan_step] 3. Construct and print the SQL query using the extracted details and report the result to the user</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">├─► [stop] Completed</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">├──● The role is `Software Engineer`, which is recognized.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   Here is the SQL query using the extracted details:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   ```sql</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   SELECT EmployeeID, Department, ProjectCode, Role, Manager, Location</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   FROM EmployeeRecords</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   WHERE EmployeeID = &#x27;E12345&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   AND Department = &#x27;Development&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   AND ProjectCode = &#x27;X987&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   AND Role = &#x27;Software Engineer&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   AND Manager = &#x27;J. Doe&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   AND Location = &#x27;Remote&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   ORDER BY EmployeeID;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   ```</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">├─► [shared_memory_entry] Add the plan to the shared memory</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">╰──● sending message to User</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> TaskWeaver ▶  The role is `Software Engineer`, which is recognized.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Here is the SQL query using the extracted details:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SELECT EmployeeID, Department, ProjectCode, Role, Manager, Location</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">FROM EmployeeRecords</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">WHERE EmployeeID = &#x27;E12345&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">AND Department = &#x27;Development&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">AND ProjectCode = &#x27;X987&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">AND Role = &#x27;Software Engineer&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">AND Manager = &#x27;J. Doe&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">AND Location = &#x27;Remote&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ORDER BY EmployeeID;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The new log is not only shorter but also more efficient. It is also more reliable according to our observations. Writing code with regex to extract information from text is error-prone.</p>
<p>In summary, we have experimented the idea of adding a special Role called <code>Recepta</code> to support the reasoning process in the Planner. The <code>Recepta</code> is not a real Role in the system, but a design pattern to support the reasoning process in the Planner. This design pattern is simple and effective. It is also flexible and can be extended to support more complex reasoning processes in the Planner. We believe that this design pattern can be useful for building more intelligent agents in the future.</p>
<p>To enable it in TaskWeaver, the user needs to configure the roles in the configure file with the following content:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token property">&quot;session.roles&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;planner&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;code_interpreter&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;recepta&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The <code>recepta</code> role is added to the list of roles.</p></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><a href="https://github.com/microsoft/TaskWeaver/tree/main/website/blog/reasoning.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/TaskWeaver/blog/vision"><div class="pagination-nav__sublabel">Newer post</div><div class="pagination-nav__label">Vision input for the Planner</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/TaskWeaver/blog/experience"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">Experience Selection in TaskWeaver</div></a></nav></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/TaskWeaver/docs/overview">Docs</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.gg/Z56MXmZgMb" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/microsoft/taskweaver/" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 TaskWeaver</div></div></div></footer></div>
</body>
</html>